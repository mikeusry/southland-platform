---
/**
 * Backyard Flock Outcome Survey (Betty Persona)
 *
 * CDP Week 1 - Post-purchase outcome collection
 *
 * Triggered via Klaviyo at 30/60/90 days post-purchase.
 * URL format: /survey/backyard?order_id=123&email=betty@example.com
 *
 * Questions focus on:
 * - Flock health improvement
 * - Egg production changes
 * - Problem resolution
 * - Product satisfaction
 * - Likelihood to recommend
 */
import BaseLayout from '../../layouts/BaseLayout.astro';
import OutcomeSurvey from '../../components/cdp/OutcomeSurvey.astro';

const title = "How's Your Flock Doing? | Southland Organics";
const description = "Share your experience with Southland Organics products and help us improve.";

// Betty's survey questions - focused on backyard flock outcomes
const questions = [
  {
    id: 'overall_health',
    type: 'rating' as const,
    question: "How would you rate your flock's overall health since using our products?",
    description: "1 = Much worse, 5 = Much better",
    required: true,
    min: 1,
    max: 5,
  },
  {
    id: 'health_changes',
    type: 'multiselect' as const,
    question: "What improvements have you noticed? (Select all that apply)",
    options: [
      { value: 'more_active', label: 'Birds are more active and alert' },
      { value: 'better_feathers', label: 'Better feather condition' },
      { value: 'fewer_sick', label: 'Fewer sick birds' },
      { value: 'better_droppings', label: 'Healthier droppings' },
      { value: 'less_smell', label: 'Less coop odor' },
      { value: 'egg_quality', label: 'Better egg quality' },
      { value: 'no_change', label: "Haven't noticed changes yet" },
    ],
  },
  {
    id: 'egg_production',
    type: 'select' as const,
    question: "How has egg production changed since using our products?",
    required: true,
    options: [
      { value: 'significant_increase', label: 'Significant increase (20%+)' },
      { value: 'slight_increase', label: 'Slight increase (5-20%)' },
      { value: 'no_change', label: 'About the same' },
      { value: 'slight_decrease', label: 'Slight decrease' },
      { value: 'not_applicable', label: "N/A - Don't track egg production" },
    ],
  },
  {
    id: 'problem_solved',
    type: 'select' as const,
    question: "Did our products help solve a specific problem you were experiencing?",
    required: true,
    options: [
      { value: 'yes_completely', label: 'Yes, problem completely resolved' },
      { value: 'yes_improved', label: 'Yes, significantly improved' },
      { value: 'somewhat', label: 'Somewhat helpful' },
      { value: 'no_change', label: 'No noticeable change' },
      { value: 'no_problem', label: "Wasn't trying to solve a specific problem" },
    ],
  },
  {
    id: 'problem_description',
    type: 'text' as const,
    question: "What problem were you trying to solve? (Optional)",
    placeholder: "e.g., Respiratory issues, low egg production, pasty butt in chicks...",
    required: false,
  },
  {
    id: 'flock_size',
    type: 'select' as const,
    question: "How many birds do you currently have?",
    required: true,
    options: [
      { value: '1-5', label: '1-5 birds' },
      { value: '6-15', label: '6-15 birds' },
      { value: '16-30', label: '16-30 birds' },
      { value: '31-50', label: '31-50 birds' },
      { value: '50+', label: '50+ birds' },
    ],
  },
  {
    id: 'ease_of_use',
    type: 'rating' as const,
    question: "How easy was the product to use?",
    description: "1 = Very difficult, 5 = Very easy",
    required: true,
    min: 1,
    max: 5,
  },
  {
    id: 'value_rating',
    type: 'rating' as const,
    question: "How would you rate the value for the price?",
    description: "1 = Poor value, 5 = Excellent value",
    required: true,
    min: 1,
    max: 5,
  },
  {
    id: 'nps',
    type: 'rating' as const,
    question: "How likely are you to recommend Southland Organics to a friend?",
    description: "1 = Not at all likely, 10 = Extremely likely",
    required: true,
    min: 1,
    max: 10,
  },
  {
    id: 'testimonial',
    type: 'text' as const,
    question: "Would you like to share your experience? (We may feature this on our website)",
    placeholder: "Tell us about your results...",
    required: false,
  },
  {
    id: 'can_contact',
    type: 'select' as const,
    question: "May we contact you for a more detailed testimonial or case study?",
    options: [
      { value: 'yes', label: 'Yes, feel free to reach out' },
      { value: 'no', label: 'No thanks' },
    ],
  },
];
---

<BaseLayout title={title} description={description} noIndex={true}>
  <section class="py-12 bg-gradient-to-b from-amber-50 to-white min-h-screen">
    <div class="max-w-2xl mx-auto px-4">
      <!-- Branding -->
      <div class="text-center mb-8">
        <img
          src="https://res.cloudinary.com/southland-organics/image/upload/c_scale,w_200/v1/Southland%20Website/Southland%20Branding/logos/southland-logo-primary.png"
          alt="Southland Organics"
          class="h-12 mx-auto mb-4"
          width="200"
          height="48"
        />
        <span class="inline-block px-3 py-1 bg-amber-100 text-amber-700 text-sm font-medium rounded-full">
          Backyard Flock Feedback
        </span>
      </div>

      <!-- Survey Component -->
      <OutcomeSurvey
        surveyId="backyard-outcome-v1"
        persona="backyard"
        title="How's Your Flock Doing?"
        description="Your feedback helps us create better products for backyard chicken keepers like you. This survey takes about 2 minutes."
        questions={questions}
        successMessage="Your feedback means the world to us! We're committed to helping backyard flocks thrive naturally."
      />
    </div>
  </section>
</BaseLayout>
